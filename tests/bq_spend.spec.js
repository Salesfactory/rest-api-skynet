const {
    calculatePercentageMonthElapsed,
    parseMonthYearToIndexAndYear,
    calculateDaysInMonth,
    calculateDaysElapsedInMonth,
    calculateRemainingDaysInMonth,
    computeAndStoreMetrics,
} = require('../src/utils/bq_spend');

const { bigqueryClient } = require('../src/config/bigquery');

jest.mock('../src/config/bigquery', () => ({
    bigqueryClient: {
        query: jest.fn(),
    },
}));

describe('parseMonthYearToIndexAndYear', () => {
    it('should return correct month index and year for valid input', () => {
        expect(parseMonthYearToIndexAndYear('January 2020')).toEqual({
            monthIndex: 0,
            year: 2020,
        });
    });

    it('should return both monthIndex and year as null for non-integer year', () => {
        expect(parseMonthYearToIndexAndYear('January NotAYear')).toEqual({
            monthIndex: 0,
            year: null,
        });
    });

    it('should handle case insensitivity for month names', () => {
        expect(parseMonthYearToIndexAndYear('jAnUaRy 2020')).toEqual({
            monthIndex: 0,
            year: 2020,
        });
    });

    it('should return monthIndex as 0 and year as null for only month provided', () => {
        expect(parseMonthYearToIndexAndYear('January')).toEqual({
            monthIndex: 0,
            year: null,
        });
    });

    it('should return monthIndex as -1 and year as parsed year for only year provided', () => {
        expect(parseMonthYearToIndexAndYear('2020')).toEqual({
            monthIndex: -1,
            year: null,
        });
    });
});

describe('calculatePercentageMonthElapsed', () => {
    it('should return 100% if the current date year is greater than provided year', () => {
        const result = calculatePercentageMonthElapsed({
            currentDate: new Date('2024-01-15'),
            monthIndex: 5,
            year: 2023,
        });
        expect(result).toBe(100);
    });

    it('should return 100% if the current date month is greater than provided month in the same year', () => {
        const result = calculatePercentageMonthElapsed({
            currentDate: new Date('2023-07-15'),
            monthIndex: 5,
            year: 2023,
        });
        expect(result).toBe(100);
    });

    it('should return the correct percentage for the current month', () => {
        const result = calculatePercentageMonthElapsed({
            currentDate: new Date(
                'Jun 15 2023 11:36:22 GMT-0400 (Venezuela Time)'
            ),
            monthIndex: 5,
            year: 2023,
        });
        // For June 2023, by the 15th, 50% of the month (30 days) has elapsed.
        expect(result).toBeCloseTo(50, 2);
    });

    it('should return 0% if the current date year is less than the provided year', () => {
        const result = calculatePercentageMonthElapsed({
            currentDate: new Date('2022-12-31'),
            monthIndex: 5,
            year: 2023,
        });
        expect(result).toBe(0);
    });

    it('should return 0% if the current date month is less than the provided month in the same year', () => {
        const result = calculatePercentageMonthElapsed({
            currentDate: new Date('2023-04-01'),
            monthIndex: 5,
            year: 2023,
        });
        expect(result).toBe(0);
    });
});

describe('calculateDaysInMonth', () => {
    it('should return 31 for January', () => {
        const result = calculateDaysInMonth({ monthIndex: 0, year: 2023 });
        expect(result).toBe(31);
    });

    it('should return 28 for February in a common year', () => {
        const result = calculateDaysInMonth({ monthIndex: 1, year: 2023 });
        expect(result).toBe(28);
    });

    it('should return 29 for February in a leap year', () => {
        const result = calculateDaysInMonth({ monthIndex: 1, year: 2020 });
        expect(result).toBe(29);
    });

    it('should return 30 for April', () => {
        const result = calculateDaysInMonth({ monthIndex: 3, year: 2023 });
        expect(result).toBe(30);
    });

    // ... you can continue for other months if you want comprehensive coverage ...
});

describe('calculateDaysElapsedInMonth', () => {
    it('should return days elapsed in the current month', () => {
        const result = calculateDaysElapsedInMonth({
            currentDate: new Date('Sat Jan 15 2023 20:00:00'),
            monthIndex: 0,
            year: 2023,
        });
        expect(result).toBe(14);
    });

    it('should return total days of the month if current date is in a subsequent month of the same year', () => {
        const result = calculateDaysElapsedInMonth({
            currentDate: new Date('Wed Feb 01 2023 20:00:00'),
            monthIndex: 0,
            year: 2023,
        });
        expect(result).toBe(31); // January has 31 days
    });

    it('should return total days of the month if current date is in a subsequent year', () => {
        const result = calculateDaysElapsedInMonth({
            currentDate: new Date(
                'Sun Dec 31 2024 20:00:00 GMT-0400 (Venezuela Time)'
            ),
            monthIndex: 11,
            year: 2023,
        });
        expect(result).toBe(31); // December has 31 days
    });

    it('should return 0 if current date is in a preceding month of the same year', () => {
        const result = calculateDaysElapsedInMonth({
            currentDate: new Date('2023-01-01'),
            monthIndex: 2,
            year: 2023,
        });
        expect(result).toBe(0); // March has not yet occurred by January 1
    });

    it('should return 0 if current date is in a preceding year', () => {
        const result = calculateDaysElapsedInMonth({
            currentDate: new Date('2022-12-31'),
            monthIndex: 0,
            year: 2023,
        });
        expect(result).toBe(0); // January 2023 has not yet occurred by December 31, 2022
    });
});

describe('calculateRemainingDaysInMonth', () => {
    it('should return remaining days in the current month', () => {
        const result = calculateRemainingDaysInMonth({
            currentDate: new Date('Sun Jan 15 2023 20:00:00'),
            monthIndex: 0,
            year: 2023,
        });
        expect(result).toBe(16); // January has 31 days, so 16 days are remaining after the 15th
    });

    it('should return 0 if current date is in a subsequent month of the same year', () => {
        const result = calculateRemainingDaysInMonth({
            currentDate: new Date('2023-02-01'),
            monthIndex: 0,
            year: 2023,
        });
        expect(result).toBe(0); // January is over
    });

    it('should return 0 if current date is in a subsequent year', () => {
        const result = calculateRemainingDaysInMonth({
            currentDate: new Date('2024-01-01'),
            monthIndex: 11,
            year: 2023,
        });
        expect(result).toBe(0); // December 2023 is over
    });

    it('should return total days if current date is in a preceding month of the same year', () => {
        const result = calculateRemainingDaysInMonth({
            currentDate: new Date('2023-01-01'),
            monthIndex: 2,
            year: 2023,
        });
        expect(result).toBe(31); // March has 31 days
    });

    it('should return total days if current date is in a preceding year', () => {
        const result = calculateRemainingDaysInMonth({
            currentDate: new Date('2022-12-31'),
            monthIndex: 0,
            year: 2023,
        });
        expect(result).toBe(31); // January 2023 has 31 days
    });
});

describe('computeAndStoreMetrics', () => {
    it('Validate computeAndStoreMetrics function for a campaign group with no bigquery ids', async () => {
        const expectedAllocations = {
            august_2023: {
                budget: 15006.576000000001,
                percentage: 16,
                allocations: [
                    {
                        id: '5',
                        name: 'LinkedIn Ads',
                        budget: 7503.2880000000005,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '5-video',
                                name: 'video',
                                budget: 7503.2880000000005,
                                percentage: 100,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                error: false,
                                mtd_spent: 0,
                                budget_remaining: 7503.2880000000005,
                                budget_spent: 100,
                                month_elapsed: 100,
                                adb: 242.04154838709678,
                                adb_current: 'N/A',
                                avg_daily_spent: 0,
                            },
                        ],
                        error: false,
                        carry_over: 0,
                        mtd_spent: 0,
                        budget_remaining: 15006.576000000001,
                        budget_spent: 100,
                        month_elapsed: 100,
                        adb: 484.08309677419356,
                        adb_current: 'N/A',
                        avg_daily_spent: 0,
                    },
                    {
                        name: 'Facebook',
                        id: '4',
                        budget: 7503.2880000000005,
                        percentage: 50,
                        type: 'CHANNEL',
                        error: false,
                    },
                ],
                error: false,
                mtd_spent: 0,
            },
            september_2023: {
                budget: 13130.754,
                percentage: 14,
                allocations: [
                    {
                        id: '5',
                        name: 'LinkedIn Ads',
                        budget: 9191.5278,
                        percentage: '70',
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '5-video',
                                name: 'video',
                                budget: 9191.5278,
                                percentage: 100,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                error: false,
                                mtd_spent: 0,
                                budget_remaining: 9191.5278,
                                budget_spent: 100,
                                month_elapsed: 66.66666666666666,
                                adb: 306.38426,
                                adb_current: 919.15278,
                                avg_daily_spent: 0,
                            },
                        ],
                        error: false,
                        carry_over: 15006.576000000001,
                        mtd_spent: 0,
                        budget_remaining: 13130.754,
                        budget_spent: 100,
                        month_elapsed: 66.66666666666666,
                        adb: 437.6918,
                        adb_current: 1313.0754000000002,
                        avg_daily_spent: 0,
                    },
                    {
                        name: 'Facebook',
                        id: '4',
                        budget: 3939.2262,
                        percentage: '30',
                        type: 'CHANNEL',
                        error: false,
                    },
                ],
                error: false,
                mtd_spent: 0,
            },
            october_2023: {
                budget: 13130.754,
                percentage: 14,
                allocations: [
                    {
                        id: '5',
                        name: 'LinkedIn Ads',
                        budget: 6565.377,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '5-video',
                                name: 'video',
                                budget: 6565.377,
                                percentage: 100,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                error: false,
                                mtd_spent: 0,
                                budget_remaining: 6565.377,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 211.78635483870968,
                                adb_current: 211.78635483870968,
                                avg_daily_spent: 'N/A',
                            },
                        ],
                        error: false,
                        carry_over: 13130.754,
                        mtd_spent: 0,
                        budget_remaining: 13130.754,
                        budget_spent: 100,
                        month_elapsed: 0,
                        adb: 423.57270967741937,
                        adb_current: 423.57270967741937,
                        avg_daily_spent: 'N/A',
                    },
                    {
                        name: 'Facebook',
                        id: '4',
                        budget: 6565.377,
                        percentage: 50,
                        type: 'CHANNEL',
                        error: false,
                    },
                ],
                error: false,
                mtd_spent: 0,
            },
            november_2023: {
                budget: 13130.754,
                percentage: 14,
                allocations: [
                    {
                        id: '5',
                        name: 'LinkedIn Ads',
                        budget: 6565.377,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '5-video',
                                name: 'video',
                                budget: 6565.377,
                                percentage: 100,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                error: false,
                                mtd_spent: 0,
                                budget_remaining: 6565.377,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 218.8459,
                                adb_current: 218.8459,
                                avg_daily_spent: 'N/A',
                            },
                        ],
                        error: false,
                        carry_over: 13130.754,
                        mtd_spent: 0,
                        budget_remaining: 13130.754,
                        budget_spent: 100,
                        month_elapsed: 0,
                        adb: 437.6918,
                        adb_current: 437.6918,
                        avg_daily_spent: 'N/A',
                    },
                    {
                        name: 'Facebook',
                        id: '4',
                        budget: 6565.377,
                        percentage: 50,
                        type: 'CHANNEL',
                        error: false,
                    },
                ],
                error: false,
                mtd_spent: 0,
            },
            december_2023: {
                budget: 13130.754,
                percentage: 14,
                allocations: [
                    {
                        id: '5',
                        name: 'LinkedIn Ads',
                        budget: 6565.377,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '5-video',
                                name: 'video',
                                budget: 6565.377,
                                percentage: 100,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                error: false,
                                mtd_spent: 0,
                                budget_remaining: 6565.377,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 211.78635483870968,
                                adb_current: 211.78635483870968,
                                avg_daily_spent: 'N/A',
                            },
                        ],
                        error: false,
                        carry_over: 13130.754,
                        mtd_spent: 0,
                        budget_remaining: 13130.754,
                        budget_spent: 100,
                        month_elapsed: 0,
                        adb: 423.57270967741937,
                        adb_current: 423.57270967741937,
                        avg_daily_spent: 'N/A',
                    },
                    {
                        name: 'Facebook',
                        id: '4',
                        budget: 6565.377,
                        percentage: 50,
                        type: 'CHANNEL',
                        error: false,
                    },
                ],
                error: false,
                mtd_spent: 0,
            },
            january_2024: {
                budget: 13130.754,
                percentage: 14,
                allocations: [
                    {
                        id: '5',
                        name: 'LinkedIn Ads',
                        budget: 6565.377,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '5-video',
                                name: 'video',
                                budget: 6565.377,
                                percentage: 100,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                error: false,
                                mtd_spent: 0,
                                budget_remaining: 6565.377,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 211.78635483870968,
                                adb_current: 211.78635483870968,
                                avg_daily_spent: 'N/A',
                            },
                        ],
                        error: false,
                        carry_over: 13130.754,
                        mtd_spent: 0,
                        budget_remaining: 13130.754,
                        budget_spent: 100,
                        month_elapsed: 0,
                        adb: 423.57270967741937,
                        adb_current: 423.57270967741937,
                        avg_daily_spent: 'N/A',
                    },
                    {
                        name: 'Facebook',
                        id: '4',
                        budget: 6565.377,
                        percentage: 50,
                        type: 'CHANNEL',
                        error: false,
                    },
                ],
                error: false,
                mtd_spent: 0,
            },
            february_2024: {
                budget: 13130.754,
                percentage: 14,
                allocations: [
                    {
                        id: '5',
                        name: 'LinkedIn Ads',
                        budget: 6565.377,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '5-video',
                                name: 'video',
                                budget: 6565.377,
                                percentage: 100,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                error: false,
                                mtd_spent: 0,
                                budget_remaining: 6565.377,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 226.3923103448276,
                                adb_current: 226.3923103448276,
                                avg_daily_spent: 'N/A',
                            },
                        ],
                        error: false,
                        carry_over: 13130.754,
                        mtd_spent: 0,
                        budget_remaining: 13130.754,
                        budget_spent: 100,
                        month_elapsed: 0,
                        adb: 452.7846206896552,
                        adb_current: 452.7846206896552,
                        avg_daily_spent: 'N/A',
                    },
                    {
                        name: 'Facebook',
                        id: '4',
                        budget: 6565.377,
                        percentage: 50,
                        type: 'CHANNEL',
                        error: false,
                    },
                ],
                error: false,
                mtd_spent: 0,
            },
        };

        const campaign = {
            id: 38,
            client_id: 4,
            name: 'Sports Broadcast 1',
            company_name: 'SFW Agency',
            goals: 'Awareness and Increase Revenue',
            total_gross_budget: 120245,
            margin: 0.22,
            channels: [
                { id: '4', name: 'Facebook' },
                { id: '5', name: 'LinkedIn Ads' },
            ],
            net_budget: 93791.1,
            comments: null,
            change_reason_log: null,
            status: 'N/S',
            budgets: [
                {
                    periods: [
                        { id: 'august_2023', label: 'August 2023' },
                        { id: 'september_2023', label: 'September 2023' },
                        { id: 'october_2023', label: 'October 2023' },
                        { id: 'november_2023', label: 'November 2023' },
                        { id: 'december_2023', label: 'December 2023' },
                        { id: 'january_2024', label: 'January 2024' },
                        { id: 'february_2024', label: 'February 2024' },
                    ],
                    allocations: {
                        august_2023: {
                            budget: 15006.576000000001,
                            percentage: 16,
                            allocations: [
                                {
                                    id: '5',
                                    name: 'LinkedIn Ads',
                                    budget: 7503.2880000000005,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '5-video',
                                            name: 'video',
                                            budget: 7503.2880000000005,
                                            percentage: 100,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '5-video-Campaign Name 1',
                                                    name: 'Campaign Name 1',
                                                    budget: 1500.6576000000002,
                                                    percentage: '20',
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 1-CN1 Adset 1',
                                                            name: 'CN1 Adset 1',
                                                            budget: 750.3288000000001,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 1-CN1 Adset 2',
                                                            name: 'CN1 Adset 2',
                                                            budget: 750.3288000000001,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                                {
                                                    id: '5-video-Campaign Name 2',
                                                    name: 'Campaign Name 2',
                                                    budget: 5252.3016,
                                                    percentage: '70',
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 2-CN2 Adset 1',
                                                            name: 'CN2 Adset 1',
                                                            budget: 2626.1508,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 2-CN2 Adset 2',
                                                            name: 'CN2 Adset 2',
                                                            budget: 2626.1508,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                                {
                                                    id: '5-video-Campaign Name 3',
                                                    name: 'Campaign Name 3',
                                                    budget: 750.3288000000001,
                                                    percentage: '10',
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 1',
                                                            name: 'CN3 Adset 1',
                                                            budget: 255.11179200000007,
                                                            percentage: 34,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 2',
                                                            name: 'CN3 Adset 2',
                                                            budget: 247.60850400000004,
                                                            percentage: 33,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 3',
                                                            name: 'CN3 Adset 3',
                                                            budget: 247.60850400000004,
                                                            percentage: 33,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                            ],
                                            error: false,
                                        },
                                    ],
                                    error: false,
                                },
                                {
                                    name: 'Facebook',
                                    id: '4',
                                    budget: 7503.2880000000005,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    error: false,
                                },
                            ],
                            error: false,
                        },
                        september_2023: {
                            budget: 13130.754,
                            percentage: 14,
                            allocations: [
                                {
                                    id: '5',
                                    name: 'LinkedIn Ads',
                                    budget: 9191.5278,
                                    percentage: '70',
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '5-video',
                                            name: 'video',
                                            budget: 9191.5278,
                                            percentage: 100,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '5-video-Campaign Name 1',
                                                    name: 'Campaign Name 1',
                                                    budget: 3125.1194520000004,
                                                    percentage: 34,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 1-CN1 Adset 1',
                                                            name: 'CN1 Adset 1',
                                                            budget: 1562.5597260000002,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 1-CN1 Adset 2',
                                                            name: 'CN1 Adset 2',
                                                            budget: 1562.5597260000002,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                                {
                                                    id: '5-video-Campaign Name 2',
                                                    name: 'Campaign Name 2',
                                                    budget: 3033.204174,
                                                    percentage: 33,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 2-CN2 Adset 1',
                                                            name: 'CN2 Adset 1',
                                                            budget: 1516.602087,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 2-CN2 Adset 2',
                                                            name: 'CN2 Adset 2',
                                                            budget: 1516.602087,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                                {
                                                    id: '5-video-Campaign Name 3',
                                                    name: 'Campaign Name 3',
                                                    budget: 3033.204174,
                                                    percentage: 33,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 1',
                                                            name: 'CN3 Adset 1',
                                                            budget: 1031.28941916,
                                                            percentage: 34,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 2',
                                                            name: 'CN3 Adset 2',
                                                            budget: 1000.9573774200001,
                                                            percentage: 33,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 3',
                                                            name: 'CN3 Adset 3',
                                                            budget: 1000.9573774200001,
                                                            percentage: 33,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                            ],
                                            error: false,
                                        },
                                    ],
                                    error: false,
                                },
                                {
                                    name: 'Facebook',
                                    id: '4',
                                    budget: 3939.2262,
                                    percentage: '30',
                                    type: 'CHANNEL',
                                    error: false,
                                },
                            ],
                            error: false,
                        },
                        october_2023: {
                            budget: 13130.754,
                            percentage: 14,
                            allocations: [
                                {
                                    id: '5',
                                    name: 'LinkedIn Ads',
                                    budget: 6565.377,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '5-video',
                                            name: 'video',
                                            budget: 6565.377,
                                            percentage: 100,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '5-video-Campaign Name 1',
                                                    name: 'Campaign Name 1',
                                                    budget: 2232.2281800000005,
                                                    percentage: 34,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 1-CN1 Adset 1',
                                                            name: 'CN1 Adset 1',
                                                            budget: 0,
                                                            percentage: '0',
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 1-CN1 Adset 2',
                                                            name: 'CN1 Adset 2',
                                                            budget: 2232.2281800000005,
                                                            percentage: '100',
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                                {
                                                    id: '5-video-Campaign Name 2',
                                                    name: 'Campaign Name 2',
                                                    budget: 2166.57441,
                                                    percentage: 33,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 2-CN2 Adset 1',
                                                            name: 'CN2 Adset 1',
                                                            budget: 1083.287205,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 2-CN2 Adset 2',
                                                            name: 'CN2 Adset 2',
                                                            budget: 1083.287205,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                                {
                                                    id: '5-video-Campaign Name 3',
                                                    name: 'Campaign Name 3',
                                                    budget: 2166.57441,
                                                    percentage: 33,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 1',
                                                            name: 'CN3 Adset 1',
                                                            budget: 736.6352994000001,
                                                            percentage: 34,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 2',
                                                            name: 'CN3 Adset 2',
                                                            budget: 714.9695553000001,
                                                            percentage: 33,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 3',
                                                            name: 'CN3 Adset 3',
                                                            budget: 714.9695553000001,
                                                            percentage: 33,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                            ],
                                            error: false,
                                        },
                                    ],
                                    error: false,
                                },
                                {
                                    name: 'Facebook',
                                    id: '4',
                                    budget: 6565.377,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    error: false,
                                },
                            ],
                            error: false,
                        },
                        november_2023: {
                            budget: 13130.754,
                            percentage: 14,
                            allocations: [
                                {
                                    id: '5',
                                    name: 'LinkedIn Ads',
                                    budget: 6565.377,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '5-video',
                                            name: 'video',
                                            budget: 6565.377,
                                            percentage: 100,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '5-video-Campaign Name 1',
                                                    name: 'Campaign Name 1',
                                                    budget: 2232.2281800000005,
                                                    percentage: 34,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 1-CN1 Adset 1',
                                                            name: 'CN1 Adset 1',
                                                            budget: 1116.1140900000003,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 1-CN1 Adset 2',
                                                            name: 'CN1 Adset 2',
                                                            budget: 1116.1140900000003,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                                {
                                                    id: '5-video-Campaign Name 2',
                                                    name: 'Campaign Name 2',
                                                    budget: 2166.57441,
                                                    percentage: 33,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 2-CN2 Adset 1',
                                                            name: 'CN2 Adset 1',
                                                            budget: 1083.287205,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 2-CN2 Adset 2',
                                                            name: 'CN2 Adset 2',
                                                            budget: 1083.287205,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                                {
                                                    id: '5-video-Campaign Name 3',
                                                    name: 'Campaign Name 3',
                                                    budget: 2166.57441,
                                                    percentage: 33,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 1',
                                                            name: 'CN3 Adset 1',
                                                            budget: 736.6352994000001,
                                                            percentage: 34,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 2',
                                                            name: 'CN3 Adset 2',
                                                            budget: 714.9695553000001,
                                                            percentage: 33,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 3',
                                                            name: 'CN3 Adset 3',
                                                            budget: 714.9695553000001,
                                                            percentage: 33,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                            ],
                                            error: false,
                                        },
                                    ],
                                    error: false,
                                },
                                {
                                    name: 'Facebook',
                                    id: '4',
                                    budget: 6565.377,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    error: false,
                                },
                            ],
                            error: false,
                        },
                        december_2023: {
                            budget: 13130.754,
                            percentage: 14,
                            allocations: [
                                {
                                    id: '5',
                                    name: 'LinkedIn Ads',
                                    budget: 6565.377,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '5-video',
                                            name: 'video',
                                            budget: 6565.377,
                                            percentage: 100,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '5-video-Campaign Name 1',
                                                    name: 'Campaign Name 1',
                                                    budget: 2232.2281800000005,
                                                    percentage: 34,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 1-CN1 Adset 1',
                                                            name: 'CN1 Adset 1',
                                                            budget: 1116.1140900000003,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 1-CN1 Adset 2',
                                                            name: 'CN1 Adset 2',
                                                            budget: 1116.1140900000003,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                                {
                                                    id: '5-video-Campaign Name 2',
                                                    name: 'Campaign Name 2',
                                                    budget: 2166.57441,
                                                    percentage: 33,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 2-CN2 Adset 1',
                                                            name: 'CN2 Adset 1',
                                                            budget: 1083.287205,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 2-CN2 Adset 2',
                                                            name: 'CN2 Adset 2',
                                                            budget: 1083.287205,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                                {
                                                    id: '5-video-Campaign Name 3',
                                                    name: 'Campaign Name 3',
                                                    budget: 2166.57441,
                                                    percentage: 33,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 1',
                                                            name: 'CN3 Adset 1',
                                                            budget: 736.6352994000001,
                                                            percentage: 34,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 2',
                                                            name: 'CN3 Adset 2',
                                                            budget: 714.9695553000001,
                                                            percentage: 33,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 3',
                                                            name: 'CN3 Adset 3',
                                                            budget: 714.9695553000001,
                                                            percentage: 33,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                            ],
                                            error: false,
                                        },
                                    ],
                                    error: false,
                                },
                                {
                                    name: 'Facebook',
                                    id: '4',
                                    budget: 6565.377,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    error: false,
                                },
                            ],
                            error: false,
                        },
                        january_2024: {
                            budget: 13130.754,
                            percentage: 14,
                            allocations: [
                                {
                                    id: '5',
                                    name: 'LinkedIn Ads',
                                    budget: 6565.377,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '5-video',
                                            name: 'video',
                                            budget: 6565.377,
                                            percentage: 100,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '5-video-Campaign Name 1',
                                                    name: 'Campaign Name 1',
                                                    budget: 2232.2281800000005,
                                                    percentage: 34,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 1-CN1 Adset 1',
                                                            name: 'CN1 Adset 1',
                                                            budget: 1116.1140900000003,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 1-CN1 Adset 2',
                                                            name: 'CN1 Adset 2',
                                                            budget: 1116.1140900000003,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                                {
                                                    id: '5-video-Campaign Name 2',
                                                    name: 'Campaign Name 2',
                                                    budget: 2166.57441,
                                                    percentage: 33,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 2-CN2 Adset 1',
                                                            name: 'CN2 Adset 1',
                                                            budget: 1083.287205,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 2-CN2 Adset 2',
                                                            name: 'CN2 Adset 2',
                                                            budget: 1083.287205,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                                {
                                                    id: '5-video-Campaign Name 3',
                                                    name: 'Campaign Name 3',
                                                    budget: 2166.57441,
                                                    percentage: 33,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 1',
                                                            name: 'CN3 Adset 1',
                                                            budget: 736.6352994000001,
                                                            percentage: 34,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 2',
                                                            name: 'CN3 Adset 2',
                                                            budget: 714.9695553000001,
                                                            percentage: 33,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 3',
                                                            name: 'CN3 Adset 3',
                                                            budget: 714.9695553000001,
                                                            percentage: 33,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                            ],
                                            error: false,
                                        },
                                    ],
                                    error: false,
                                },
                                {
                                    name: 'Facebook',
                                    id: '4',
                                    budget: 6565.377,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    error: false,
                                },
                            ],
                            error: false,
                        },
                        february_2024: {
                            budget: 13130.754,
                            percentage: 14,
                            allocations: [
                                {
                                    id: '5',
                                    name: 'LinkedIn Ads',
                                    budget: 6565.377,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '5-video',
                                            name: 'video',
                                            budget: 6565.377,
                                            percentage: 100,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '5-video-Campaign Name 1',
                                                    name: 'Campaign Name 1',
                                                    budget: 2232.2281800000005,
                                                    percentage: 34,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 1-CN1 Adset 1',
                                                            name: 'CN1 Adset 1',
                                                            budget: 1116.1140900000003,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 1-CN1 Adset 2',
                                                            name: 'CN1 Adset 2',
                                                            budget: 1116.1140900000003,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                                {
                                                    id: '5-video-Campaign Name 2',
                                                    name: 'Campaign Name 2',
                                                    budget: 2166.57441,
                                                    percentage: 33,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 2-CN2 Adset 1',
                                                            name: 'CN2 Adset 1',
                                                            budget: 1083.287205,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 2-CN2 Adset 2',
                                                            name: 'CN2 Adset 2',
                                                            budget: 1083.287205,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                                {
                                                    id: '5-video-Campaign Name 3',
                                                    name: 'Campaign Name 3',
                                                    budget: 2166.57441,
                                                    percentage: 33,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 1',
                                                            name: 'CN3 Adset 1',
                                                            budget: 736.6352994000001,
                                                            percentage: 34,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 2',
                                                            name: 'CN3 Adset 2',
                                                            budget: 714.9695553000001,
                                                            percentage: 33,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                        {
                                                            id: '5-video-Campaign Name 3-CN3 Adset 3',
                                                            name: 'CN3 Adset 3',
                                                            budget: 714.9695553000001,
                                                            percentage: 33,
                                                            type: 'ADSET',
                                                            error: false,
                                                        },
                                                    ],
                                                    error: false,
                                                },
                                            ],
                                            error: false,
                                        },
                                    ],
                                    error: false,
                                },
                                {
                                    name: 'Facebook',
                                    id: '4',
                                    budget: 6565.377,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    error: false,
                                },
                            ],
                            error: false,
                        },
                    },
                },
            ],
        };

        const currentDate = new Date('Sep 20 2023');

        const { periods, allocations } = await computeAndStoreMetrics({
            campaign,
            currentDate,
        });

        expect(periods).toEqual(campaign.budgets[0].periods);
        expect(allocations).toEqual(expectedAllocations);
    });

    it('Validate computeAndStoreMetrics function for a campaign group with bigquery ids', async () => {
        const expectedAllocations = {
            september_2023: {
                budget: 2154.8,
                percentage: '10',
                allocations: [
                    {
                        id: '1',
                        name: 'Google Ads',
                        budget: 1077.4,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '1-SEARCH',
                                name: 'SEARCH',
                                budget: 538.7,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [
                                    {
                                        id: '1-SEARCH-Products',
                                        name: 'Primo Market Test | Bakersfield',
                                        budget: 269.35,
                                        percentage: 50,
                                        goals: '',
                                        type: 'CAMPAIGN',
                                        allocations: [
                                            {
                                                id: '1-SEARCH-Products-Water',
                                                name: 'Mindful Morgan',
                                                budget: 134.675,
                                                percentage: 50,
                                                type: 'ADSET',
                                                bigquery_adset_id:
                                                    '142232761402',
                                                mtd_spent: 0,
                                                budget_remaining: 269.35,
                                                budget_spent: 100,
                                                month_elapsed: 66.66666666666666,
                                                adb: 8.978333333333333,
                                                adb_current: 26.935000000000002,
                                                avg_daily_spent: 0,
                                            },
                                        ],
                                        bigquery_campaign_id: '18195521903',
                                        mtd_spent: 0,
                                        budget_remaining: 538.7,
                                        budget_spent: 100,
                                        month_elapsed: 66.66666666666666,
                                        adb: 17.956666666666667,
                                        adb_current: 53.870000000000005,
                                        avg_daily_spent: 0,
                                    },
                                    {
                                        id: '1-SEARCH-Services',
                                        name: 'Primo Market Test | Lafayette',
                                        budget: 269.35,
                                        percentage: 50,
                                        goals: '',
                                        type: 'CAMPAIGN',
                                        allocations: [
                                            {
                                                id: '1-SEARCH-Services-Dispenser',
                                                name: 'Striving Selena',
                                                budget: 134.675,
                                                percentage: 50,
                                                type: 'ADSET',
                                                bigquery_adset_id:
                                                    '143495582551',
                                                mtd_spent: 0,
                                                budget_remaining: 269.35,
                                                budget_spent: 100,
                                                month_elapsed: 66.66666666666666,
                                                adb: 8.978333333333333,
                                                adb_current: 26.935000000000002,
                                                avg_daily_spent: 0,
                                            },
                                        ],
                                        bigquery_campaign_id: '18197143856',
                                        mtd_spent: 0,
                                        budget_remaining: 538.7,
                                        budget_spent: 100,
                                        month_elapsed: 66.66666666666666,
                                        adb: 17.956666666666667,
                                        adb_current: 53.870000000000005,
                                        avg_daily_spent: 0,
                                    },
                                ],
                                mtd_spent: 0,
                                budget_remaining: 1077.4,
                                budget_spent: 100,
                                month_elapsed: 66.66666666666666,
                                adb: 35.913333333333334,
                                adb_current: 107.74000000000001,
                                avg_daily_spent: 0,
                            },
                            {
                                id: '1-SHOPPING',
                                name: 'SHOPPING',
                                budget: 538.7,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 1077.4,
                                budget_spent: 100,
                                month_elapsed: 66.66666666666666,
                                adb: 35.913333333333334,
                                adb_current: 107.74000000000001,
                                avg_daily_spent: 0,
                            },
                        ],
                        error: false,
                        carry_over: 0,
                        mtd_spent: 0,
                        budget_remaining: 2154.8,
                        budget_spent: 100,
                        month_elapsed: 66.66666666666666,
                        adb: 71.82666666666667,
                        adb_current: 215.48000000000002,
                        avg_daily_spent: 0,
                    },
                    {
                        id: '2',
                        name: 'Amazon Advertising',
                        budget: 1077.4,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '2-Sponsored Display',
                                name: 'Sponsored Display',
                                budget: 538.7,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 1077.4,
                                budget_spent: 100,
                                month_elapsed: 66.66666666666666,
                                adb: 35.913333333333334,
                                adb_current: 107.74000000000001,
                                avg_daily_spent: 0,
                            },
                            {
                                id: '2-Sponsored Products',
                                name: 'Sponsored Products',
                                budget: 538.7,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 1077.4,
                                budget_spent: 100,
                                month_elapsed: 66.66666666666666,
                                adb: 35.913333333333334,
                                adb_current: 107.74000000000001,
                                avg_daily_spent: 0,
                            },
                        ],
                        error: false,
                        carry_over: 0,
                        mtd_spent: 0,
                        budget_remaining: 2154.8,
                        budget_spent: 100,
                        month_elapsed: 66.66666666666666,
                        adb: 71.82666666666667,
                        adb_current: 215.48000000000002,
                        avg_daily_spent: 0,
                    },
                ],
                error: false,
                mtd_spent: 0,
            },
            october_2023: {
                budget: 2370.28,
                percentage: '11',
                allocations: [
                    {
                        id: '1',
                        name: 'Google Ads',
                        budget: 1185.14,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '1-SEARCH',
                                name: 'SEARCH',
                                budget: 592.57,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [
                                    {
                                        id: '1-SEARCH-Products',
                                        name: 'Primo Market Test | Bakersfield',
                                        budget: 296.285,
                                        percentage: 50,
                                        goals: '',
                                        type: 'CAMPAIGN',
                                        allocations: [
                                            {
                                                id: '1-SEARCH-Products-Water',
                                                name: 'Mindful Morgan',
                                                budget: 148.1425,
                                                percentage: 50,
                                                type: 'ADSET',
                                                bigquery_adset_id:
                                                    '142232761402',
                                                mtd_spent: 0,
                                                budget_remaining: 296.285,
                                                budget_spent: 100,
                                                month_elapsed: 0,
                                                adb: 9.557580645161291,
                                                adb_current: 9.557580645161291,
                                                avg_daily_spent: 'N/A',
                                            },
                                        ],
                                        bigquery_campaign_id: '18195521903',
                                        mtd_spent: 0,
                                        budget_remaining: 592.57,
                                        budget_spent: 100,
                                        month_elapsed: 0,
                                        adb: 19.115161290322582,
                                        adb_current: 19.115161290322582,
                                        avg_daily_spent: 'N/A',
                                    },
                                    {
                                        id: '1-SEARCH-Services',
                                        name: 'Primo Market Test | Lafayette',
                                        budget: 296.285,
                                        percentage: 50,
                                        goals: '',
                                        type: 'CAMPAIGN',
                                        allocations: [
                                            {
                                                id: '1-SEARCH-Services-Dispenser',
                                                name: 'Striving Selena',
                                                budget: 148.1425,
                                                percentage: 50,
                                                type: 'ADSET',
                                                bigquery_adset_id:
                                                    '143495582551',
                                                mtd_spent: 0,
                                                budget_remaining: 296.285,
                                                budget_spent: 100,
                                                month_elapsed: 0,
                                                adb: 9.557580645161291,
                                                adb_current: 9.557580645161291,
                                                avg_daily_spent: 'N/A',
                                            },
                                        ],
                                        bigquery_campaign_id: '18197143856',
                                        mtd_spent: 0,
                                        budget_remaining: 592.57,
                                        budget_spent: 100,
                                        month_elapsed: 0,
                                        adb: 19.115161290322582,
                                        adb_current: 19.115161290322582,
                                        avg_daily_spent: 'N/A',
                                    },
                                ],
                                mtd_spent: 0,
                                budget_remaining: 1185.14,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 38.230322580645165,
                                adb_current: 38.230322580645165,
                                avg_daily_spent: 'N/A',
                            },
                            {
                                id: '1-SHOPPING',
                                name: 'SHOPPING',
                                budget: 592.57,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 1185.14,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 38.230322580645165,
                                adb_current: 38.230322580645165,
                                avg_daily_spent: 'N/A',
                            },
                        ],
                        error: false,
                        carry_over: 2154.8,
                        mtd_spent: 0,
                        budget_remaining: 2370.28,
                        budget_spent: 100,
                        month_elapsed: 0,
                        adb: 76.46064516129033,
                        adb_current: 76.46064516129033,
                        avg_daily_spent: 'N/A',
                    },
                    {
                        id: '2',
                        name: 'Amazon Advertising',
                        budget: 1185.14,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '2-Sponsored Display',
                                name: 'Sponsored Display',
                                budget: 592.57,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 1185.14,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 38.230322580645165,
                                adb_current: 38.230322580645165,
                                avg_daily_spent: 'N/A',
                            },
                            {
                                id: '2-Sponsored Products',
                                name: 'Sponsored Products',
                                budget: 592.57,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 1185.14,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 38.230322580645165,
                                adb_current: 38.230322580645165,
                                avg_daily_spent: 'N/A',
                            },
                        ],
                        error: false,
                        carry_over: 2154.8,
                        mtd_spent: 0,
                        budget_remaining: 2370.28,
                        budget_spent: 100,
                        month_elapsed: 0,
                        adb: 76.46064516129033,
                        adb_current: 76.46064516129033,
                        avg_daily_spent: 'N/A',
                    },
                ],
                error: false,
                mtd_spent: 0,
            },
            november_2023: {
                budget: 7110.84,
                percentage: '33',
                allocations: [
                    {
                        id: '1',
                        name: 'Google Ads',
                        budget: 3555.42,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '1-SEARCH',
                                name: 'SEARCH',
                                budget: 1777.71,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [
                                    {
                                        id: '1-SEARCH-Products',
                                        name: 'Primo Market Test | Bakersfield',
                                        budget: 888.855,
                                        percentage: 50,
                                        goals: '',
                                        type: 'CAMPAIGN',
                                        allocations: [
                                            {
                                                id: '1-SEARCH-Products-Water',
                                                name: 'Mindful Morgan',
                                                budget: 444.4275,
                                                percentage: 50,
                                                type: 'ADSET',
                                                bigquery_adset_id:
                                                    '142232761402',
                                                mtd_spent: 0,
                                                budget_remaining: 888.855,
                                                budget_spent: 100,
                                                month_elapsed: 0,
                                                adb: 29.6285,
                                                adb_current: 29.6285,
                                                avg_daily_spent: 'N/A',
                                            },
                                        ],
                                        bigquery_campaign_id: '18195521903',
                                        mtd_spent: 0,
                                        budget_remaining: 1777.71,
                                        budget_spent: 100,
                                        month_elapsed: 0,
                                        adb: 59.257,
                                        adb_current: 59.257,
                                        avg_daily_spent: 'N/A',
                                    },
                                    {
                                        id: '1-SEARCH-Services',
                                        name: 'Primo Market Test | Lafayette',
                                        budget: 888.855,
                                        percentage: 50,
                                        goals: '',
                                        type: 'CAMPAIGN',
                                        allocations: [
                                            {
                                                id: '1-SEARCH-Services-Dispenser',
                                                name: 'Striving Selena',
                                                budget: 444.4275,
                                                percentage: 50,
                                                type: 'ADSET',
                                                bigquery_adset_id:
                                                    '143495582551',
                                                mtd_spent: 0,
                                                budget_remaining: 888.855,
                                                budget_spent: 100,
                                                month_elapsed: 0,
                                                adb: 29.6285,
                                                adb_current: 29.6285,
                                                avg_daily_spent: 'N/A',
                                            },
                                        ],
                                        bigquery_campaign_id: '18197143856',
                                        mtd_spent: 0,
                                        budget_remaining: 1777.71,
                                        budget_spent: 100,
                                        month_elapsed: 0,
                                        adb: 59.257,
                                        adb_current: 59.257,
                                        avg_daily_spent: 'N/A',
                                    },
                                ],
                                mtd_spent: 0,
                                budget_remaining: 3555.42,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 118.514,
                                adb_current: 118.514,
                                avg_daily_spent: 'N/A',
                            },
                            {
                                id: '1-SHOPPING',
                                name: 'SHOPPING',
                                budget: 1777.71,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 3555.42,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 118.514,
                                adb_current: 118.514,
                                avg_daily_spent: 'N/A',
                            },
                        ],
                        error: false,
                        carry_over: 2370.28,
                        mtd_spent: 0,
                        budget_remaining: 7110.84,
                        budget_spent: 100,
                        month_elapsed: 0,
                        adb: 237.028,
                        adb_current: 237.028,
                        avg_daily_spent: 'N/A',
                    },
                    {
                        id: '2',
                        name: 'Amazon Advertising',
                        budget: 3555.42,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '2-Sponsored Display',
                                name: 'Sponsored Display',
                                budget: 1777.71,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 3555.42,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 118.514,
                                adb_current: 118.514,
                                avg_daily_spent: 'N/A',
                            },
                            {
                                id: '2-Sponsored Products',
                                name: 'Sponsored Products',
                                budget: 1777.71,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 3555.42,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 118.514,
                                adb_current: 118.514,
                                avg_daily_spent: 'N/A',
                            },
                        ],
                        error: false,
                        carry_over: 2370.28,
                        mtd_spent: 0,
                        budget_remaining: 7110.84,
                        budget_spent: 100,
                        month_elapsed: 0,
                        adb: 237.028,
                        adb_current: 237.028,
                        avg_daily_spent: 'N/A',
                    },
                ],
                error: false,
                mtd_spent: 0,
            },
            december_2023: {
                budget: 3447.6800000000003,
                percentage: 16,
                allocations: [
                    {
                        id: '1',
                        name: 'Google Ads',
                        budget: 1723.84,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '1-SEARCH',
                                name: 'SEARCH',
                                budget: 861.92,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [
                                    {
                                        id: '1-SEARCH-Products',
                                        name: 'Primo Market Test | Bakersfield',
                                        budget: 430.96,
                                        percentage: 50,
                                        goals: '',
                                        type: 'CAMPAIGN',
                                        allocations: [
                                            {
                                                id: '1-SEARCH-Products-Water',
                                                name: 'Mindful Morgan',
                                                budget: 215.48,
                                                percentage: 50,
                                                type: 'ADSET',
                                                bigquery_adset_id:
                                                    '142232761402',
                                                mtd_spent: 0,
                                                budget_remaining: 430.96,
                                                budget_spent: 100,
                                                month_elapsed: 0,
                                                adb: 13.901935483870966,
                                                adb_current: 13.901935483870966,
                                                avg_daily_spent: 'N/A',
                                            },
                                        ],
                                        bigquery_campaign_id: '18195521903',
                                        mtd_spent: 0,
                                        budget_remaining: 861.92,
                                        budget_spent: 100,
                                        month_elapsed: 0,
                                        adb: 27.803870967741933,
                                        adb_current: 27.803870967741933,
                                        avg_daily_spent: 'N/A',
                                    },
                                    {
                                        id: '1-SEARCH-Services',
                                        name: 'Primo Market Test | Lafayette',
                                        budget: 430.96,
                                        percentage: 50,
                                        goals: '',
                                        type: 'CAMPAIGN',
                                        allocations: [
                                            {
                                                id: '1-SEARCH-Services-Dispenser',
                                                name: 'Striving Selena',
                                                budget: 215.48,
                                                percentage: 50,
                                                type: 'ADSET',
                                                bigquery_adset_id:
                                                    '143495582551',
                                                mtd_spent: 0,
                                                budget_remaining: 430.96,
                                                budget_spent: 100,
                                                month_elapsed: 0,
                                                adb: 13.901935483870966,
                                                adb_current: 13.901935483870966,
                                                avg_daily_spent: 'N/A',
                                            },
                                        ],
                                        bigquery_campaign_id: '18197143856',
                                        mtd_spent: 0,
                                        budget_remaining: 861.92,
                                        budget_spent: 100,
                                        month_elapsed: 0,
                                        adb: 27.803870967741933,
                                        adb_current: 27.803870967741933,
                                        avg_daily_spent: 'N/A',
                                    },
                                ],
                                mtd_spent: 0,
                                budget_remaining: 1723.84,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 55.607741935483865,
                                adb_current: 55.607741935483865,
                                avg_daily_spent: 'N/A',
                            },
                            {
                                id: '1-SHOPPING',
                                name: 'SHOPPING',
                                budget: 861.92,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 1723.84,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 55.607741935483865,
                                adb_current: 55.607741935483865,
                                avg_daily_spent: 'N/A',
                            },
                        ],
                        error: false,
                        carry_over: 7110.84,
                        mtd_spent: 0,
                        budget_remaining: 3447.6800000000003,
                        budget_spent: 100,
                        month_elapsed: 0,
                        adb: 111.21548387096774,
                        adb_current: 111.21548387096774,
                        avg_daily_spent: 'N/A',
                    },
                    {
                        id: '2',
                        name: 'Amazon Advertising',
                        budget: 1723.84,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '2-Sponsored Display',
                                name: 'Sponsored Display',
                                budget: 861.92,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 1723.84,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 55.607741935483865,
                                adb_current: 55.607741935483865,
                                avg_daily_spent: 'N/A',
                            },
                            {
                                id: '2-Sponsored Products',
                                name: 'Sponsored Products',
                                budget: 861.92,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 1723.84,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 55.607741935483865,
                                adb_current: 55.607741935483865,
                                avg_daily_spent: 'N/A',
                            },
                        ],
                        error: false,
                        carry_over: 7110.84,
                        mtd_spent: 0,
                        budget_remaining: 3447.6800000000003,
                        budget_spent: 100,
                        month_elapsed: 0,
                        adb: 111.21548387096774,
                        adb_current: 111.21548387096774,
                        avg_daily_spent: 'N/A',
                    },
                ],
                error: false,
                mtd_spent: 0,
            },
            january_2024: {
                budget: 3232.2,
                percentage: '15',
                allocations: [
                    {
                        id: '1',
                        name: 'Google Ads',
                        budget: 1616.1,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '1-SEARCH',
                                name: 'SEARCH',
                                budget: 808.05,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [
                                    {
                                        id: '1-SEARCH-Products',
                                        name: 'Primo Market Test | Bakersfield',
                                        budget: 404.025,
                                        percentage: 50,
                                        goals: '',
                                        type: 'CAMPAIGN',
                                        allocations: [
                                            {
                                                id: '1-SEARCH-Products-Water',
                                                name: 'Mindful Morgan',
                                                budget: 202.0125,
                                                percentage: 50,
                                                type: 'ADSET',
                                                bigquery_adset_id:
                                                    '142232761402',
                                                mtd_spent: 0,
                                                budget_remaining: 404.025,
                                                budget_spent: 100,
                                                month_elapsed: 0,
                                                adb: 13.033064516129032,
                                                adb_current: 13.033064516129032,
                                                avg_daily_spent: 'N/A',
                                            },
                                        ],
                                        bigquery_campaign_id: '18195521903',
                                        mtd_spent: 0,
                                        budget_remaining: 808.05,
                                        budget_spent: 100,
                                        month_elapsed: 0,
                                        adb: 26.066129032258065,
                                        adb_current: 26.066129032258065,
                                        avg_daily_spent: 'N/A',
                                    },
                                    {
                                        id: '1-SEARCH-Services',
                                        name: 'Primo Market Test | Lafayette',
                                        budget: 404.025,
                                        percentage: 50,
                                        goals: '',
                                        type: 'CAMPAIGN',
                                        allocations: [
                                            {
                                                id: '1-SEARCH-Services-Dispenser',
                                                name: 'Striving Selena',
                                                budget: 202.0125,
                                                percentage: 50,
                                                type: 'ADSET',
                                                bigquery_adset_id:
                                                    '143495582551',
                                                mtd_spent: 0,
                                                budget_remaining: 404.025,
                                                budget_spent: 100,
                                                month_elapsed: 0,
                                                adb: 13.033064516129032,
                                                adb_current: 13.033064516129032,
                                                avg_daily_spent: 'N/A',
                                            },
                                        ],
                                        bigquery_campaign_id: '18197143856',
                                        mtd_spent: 0,
                                        budget_remaining: 808.05,
                                        budget_spent: 100,
                                        month_elapsed: 0,
                                        adb: 26.066129032258065,
                                        adb_current: 26.066129032258065,
                                        avg_daily_spent: 'N/A',
                                    },
                                ],
                                mtd_spent: 0,
                                budget_remaining: 1616.1,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 52.13225806451613,
                                adb_current: 52.13225806451613,
                                avg_daily_spent: 'N/A',
                            },
                            {
                                id: '1-SHOPPING',
                                name: 'SHOPPING',
                                budget: 808.05,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 1616.1,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 52.13225806451613,
                                adb_current: 52.13225806451613,
                                avg_daily_spent: 'N/A',
                            },
                        ],
                        error: false,
                        carry_over: 3447.6800000000003,
                        mtd_spent: 0,
                        budget_remaining: 3232.2,
                        budget_spent: 100,
                        month_elapsed: 0,
                        adb: 104.26451612903226,
                        adb_current: 104.26451612903226,
                        avg_daily_spent: 'N/A',
                    },
                    {
                        id: '2',
                        name: 'Amazon Advertising',
                        budget: 1616.1,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '2-Sponsored Display',
                                name: 'Sponsored Display',
                                budget: 808.05,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 1616.1,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 52.13225806451613,
                                adb_current: 52.13225806451613,
                                avg_daily_spent: 'N/A',
                            },
                            {
                                id: '2-Sponsored Products',
                                name: 'Sponsored Products',
                                budget: 808.05,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 1616.1,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 52.13225806451613,
                                adb_current: 52.13225806451613,
                                avg_daily_spent: 'N/A',
                            },
                        ],
                        error: false,
                        carry_over: 3447.6800000000003,
                        mtd_spent: 0,
                        budget_remaining: 3232.2,
                        budget_spent: 100,
                        month_elapsed: 0,
                        adb: 104.26451612903226,
                        adb_current: 104.26451612903226,
                        avg_daily_spent: 'N/A',
                    },
                ],
                error: false,
                mtd_spent: 0,
            },
            february_2024: {
                budget: 3232.2,
                percentage: '15',
                allocations: [
                    {
                        id: '1',
                        name: 'Google Ads',
                        budget: 1616.1,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '1-SEARCH',
                                name: 'SEARCH',
                                budget: 808.05,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [
                                    {
                                        id: '1-SEARCH-Products',
                                        name: 'Primo Market Test | Bakersfield',
                                        budget: 404.025,
                                        percentage: 50,
                                        goals: '',
                                        type: 'CAMPAIGN',
                                        allocations: [
                                            {
                                                id: '1-SEARCH-Products-Water',
                                                name: 'Mindful Morgan',
                                                budget: 202.0125,
                                                percentage: 50,
                                                type: 'ADSET',
                                                bigquery_adset_id:
                                                    '142232761402',
                                                mtd_spent: 0,
                                                budget_remaining: 404.025,
                                                budget_spent: 100,
                                                month_elapsed: 0,
                                                adb: 13.931896551724137,
                                                adb_current: 13.931896551724137,
                                                avg_daily_spent: 'N/A',
                                            },
                                        ],
                                        bigquery_campaign_id: '18195521903',
                                        mtd_spent: 0,
                                        budget_remaining: 808.05,
                                        budget_spent: 100,
                                        month_elapsed: 0,
                                        adb: 27.863793103448273,
                                        adb_current: 27.863793103448273,
                                        avg_daily_spent: 'N/A',
                                    },
                                    {
                                        id: '1-SEARCH-Services',
                                        name: 'Primo Market Test | Lafayette',
                                        budget: 404.025,
                                        percentage: 50,
                                        goals: '',
                                        type: 'CAMPAIGN',
                                        allocations: [
                                            {
                                                id: '1-SEARCH-Services-Dispenser',
                                                name: 'Striving Selena',
                                                budget: 202.0125,
                                                percentage: 50,
                                                type: 'ADSET',
                                                bigquery_adset_id:
                                                    '143495582551',
                                                mtd_spent: 0,
                                                budget_remaining: 404.025,
                                                budget_spent: 100,
                                                month_elapsed: 0,
                                                adb: 13.931896551724137,
                                                adb_current: 13.931896551724137,
                                                avg_daily_spent: 'N/A',
                                            },
                                        ],
                                        bigquery_campaign_id: '18197143856',
                                        mtd_spent: 0,
                                        budget_remaining: 808.05,
                                        budget_spent: 100,
                                        month_elapsed: 0,
                                        adb: 27.863793103448273,
                                        adb_current: 27.863793103448273,
                                        avg_daily_spent: 'N/A',
                                    },
                                ],
                                mtd_spent: 0,
                                budget_remaining: 1616.1,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 55.72758620689655,
                                adb_current: 55.72758620689655,
                                avg_daily_spent: 'N/A',
                            },
                            {
                                id: '1-SHOPPING',
                                name: 'SHOPPING',
                                budget: 808.05,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 1616.1,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 55.72758620689655,
                                adb_current: 55.72758620689655,
                                avg_daily_spent: 'N/A',
                            },
                        ],
                        error: false,
                        carry_over: 3232.2,
                        mtd_spent: 0,
                        budget_remaining: 3232.2,
                        budget_spent: 100,
                        month_elapsed: 0,
                        adb: 111.4551724137931,
                        adb_current: 111.4551724137931,
                        avg_daily_spent: 'N/A',
                    },
                    {
                        id: '2',
                        name: 'Amazon Advertising',
                        budget: 1616.1,
                        percentage: 50,
                        type: 'CHANNEL',
                        allocations: [
                            {
                                id: '2-Sponsored Display',
                                name: 'Sponsored Display',
                                budget: 808.05,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 1616.1,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 55.72758620689655,
                                adb_current: 55.72758620689655,
                                avg_daily_spent: 'N/A',
                            },
                            {
                                id: '2-Sponsored Products',
                                name: 'Sponsored Products',
                                budget: 808.05,
                                percentage: 50,
                                type: 'CAMPAIGN_TYPE',
                                allocations: [],
                                mtd_spent: 0,
                                budget_remaining: 1616.1,
                                budget_spent: 100,
                                month_elapsed: 0,
                                adb: 55.72758620689655,
                                adb_current: 55.72758620689655,
                                avg_daily_spent: 'N/A',
                            },
                        ],
                        error: false,
                        carry_over: 3232.2,
                        mtd_spent: 0,
                        budget_remaining: 3232.2,
                        budget_spent: 100,
                        month_elapsed: 0,
                        adb: 111.4551724137931,
                        adb_current: 111.4551724137931,
                        avg_daily_spent: 'N/A',
                    },
                ],
                error: false,
                mtd_spent: 0,
            },
        };
        const campaign = {
            id: 40,
            client_id: 2,
            name: 'asd',
            company_name: 'Primo Water',
            goals: 'asd',
            total_gross_budget: 123,
            margin: 0.12,
            channels: [
                { id: 1, name: 'Google Ads' },
                { id: 2, name: 'Amazon Advertising' },
            ],
            net_budget: 108.24,
            comments: null,
            change_reason_log: null,
            status: 'N/S',
            budgets: [
                {
                    periods: [
                        {
                            id: 'september_2023',
                            label: 'September 2023',
                            days: 30,
                        },
                        { id: 'october_2023', label: 'October 2023', days: 31 },
                        {
                            id: 'november_2023',
                            label: 'November 2023',
                            days: 30,
                        },
                        {
                            id: 'december_2023',
                            label: 'December 2023',
                            days: 31,
                        },
                        { id: 'january_2024', label: 'January 2024', days: 31 },
                        {
                            id: 'february_2024',
                            label: 'February 2024',
                            days: 29,
                        },
                    ],
                    allocations: {
                        september_2023: {
                            budget: 2154.8,
                            percentage: '10',
                            allocations: [
                                {
                                    id: '1',
                                    name: 'Google Ads',
                                    budget: 1077.4,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '1-SEARCH',
                                            name: 'SEARCH',
                                            budget: 538.7,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '1-SEARCH-Products',
                                                    name: 'Primo Market Test | Bakersfield',
                                                    budget: 269.35,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SEARCH-Products-Water',
                                                            name: 'Mindful Morgan',
                                                            budget: 134.675,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            bigquery_adset_id:
                                                                '142232761402',
                                                        },
                                                        {
                                                            id: '1-SEARCH-Products-Soda',
                                                            name: 'Soda',
                                                            budget: 134.675,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                    bigquery_campaign_id:
                                                        '18195521903',
                                                },
                                                {
                                                    id: '1-SEARCH-Services',
                                                    name: 'Primo Market Test | Lafayette',
                                                    budget: 269.35,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SEARCH-Services-Dispenser',
                                                            name: 'Striving Selena',
                                                            budget: 134.675,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            bigquery_adset_id:
                                                                '143495582551',
                                                        },
                                                        {
                                                            id: '1-SEARCH-Services-Delivery',
                                                            name: 'Delivery',
                                                            budget: 134.675,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                    bigquery_campaign_id:
                                                        '18197143856',
                                                },
                                            ],
                                        },
                                        {
                                            id: '1-SHOPPING',
                                            name: 'SHOPPING',
                                            budget: 538.7,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '1-SHOPPING-Products',
                                                    name: 'Products',
                                                    budget: 134.675,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Products-Bottled',
                                                            name: 'Bottled',
                                                            budget: 134.675,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '1-SHOPPING-Products-Free Flow',
                                                            name: 'Free Flow',
                                                            budget: 134.675,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Services',
                                                    name: 'Services',
                                                    budget: 134.675,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Services-Frontline',
                                                            name: 'Frontline',
                                                            budget: 134.675,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Home',
                                                    name: 'Home',
                                                    budget: 134.675,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Home-Program',
                                                            name: 'Program',
                                                            budget: 134.675,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Office',
                                                    name: 'Office',
                                                    budget: 134.675,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Office-Required',
                                                            name: 'Required',
                                                            budget: 134.675,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                    ],
                                    error: false,
                                },
                                {
                                    id: '2',
                                    name: 'Amazon Advertising',
                                    budget: 1077.4,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '2-Sponsored Display',
                                            name: 'Sponsored Display',
                                            budget: 538.7,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '2-Sponsored Display-Services',
                                                    name: 'Services',
                                                    budget: 538.7,
                                                    percentage: 100,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Display-Services-Delivery',
                                                            name: 'Delivery',
                                                            budget: 269.35,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '2-Sponsored Display-Services-Repair',
                                                            name: 'Repair',
                                                            budget: 269.35,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                        {
                                            id: '2-Sponsored Products',
                                            name: 'Sponsored Products',
                                            budget: 538.7,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '2-Sponsored Products-Sports Drinks',
                                                    name: 'Sports Drinks',
                                                    budget: 269.35,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Products-Sports Drinks-Gatorade',
                                                            name: 'Gatorade',
                                                            budget: 538.7,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '2-Sponsored Products-Energy Drinks',
                                                    name: 'Energy Drinks',
                                                    budget: 269.35,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Products-Energy Drinks-Monster',
                                                            name: 'Monster',
                                                            budget: 134.675,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '2-Sponsored Products-Energy Drinks-Red Bull',
                                                            name: 'Red Bull',
                                                            budget: 134.675,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                    ],
                                    error: false,
                                },
                            ],
                            error: false,
                        },
                        october_2023: {
                            budget: 2370.28,
                            percentage: '11',
                            allocations: [
                                {
                                    id: '1',
                                    name: 'Google Ads',
                                    budget: 1185.14,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '1-SEARCH',
                                            name: 'SEARCH',
                                            budget: 592.57,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '1-SEARCH-Products',
                                                    name: 'Primo Market Test | Bakersfield',
                                                    budget: 296.285,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SEARCH-Products-Water',
                                                            name: 'Mindful Morgan',
                                                            budget: 148.1425,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            bigquery_adset_id:
                                                                '142232761402',
                                                        },
                                                        {
                                                            id: '1-SEARCH-Products-Soda',
                                                            name: 'Soda',
                                                            budget: 148.1425,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                    bigquery_campaign_id:
                                                        '18195521903',
                                                },
                                                {
                                                    id: '1-SEARCH-Services',
                                                    name: 'Primo Market Test | Lafayette',
                                                    budget: 296.285,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SEARCH-Services-Dispenser',
                                                            name: 'Striving Selena',
                                                            budget: 148.1425,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            bigquery_adset_id:
                                                                '143495582551',
                                                        },
                                                        {
                                                            id: '1-SEARCH-Services-Delivery',
                                                            name: 'Delivery',
                                                            budget: 148.1425,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                    bigquery_campaign_id:
                                                        '18197143856',
                                                },
                                            ],
                                        },
                                        {
                                            id: '1-SHOPPING',
                                            name: 'SHOPPING',
                                            budget: 592.57,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '1-SHOPPING-Products',
                                                    name: 'Products',
                                                    budget: 148.1425,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Products-Bottled',
                                                            name: 'Bottled',
                                                            budget: 148.1425,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '1-SHOPPING-Products-Free Flow',
                                                            name: 'Free Flow',
                                                            budget: 148.1425,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Services',
                                                    name: 'Services',
                                                    budget: 148.1425,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Services-Frontline',
                                                            name: 'Frontline',
                                                            budget: 148.1425,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Home',
                                                    name: 'Home',
                                                    budget: 148.1425,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Home-Program',
                                                            name: 'Program',
                                                            budget: 148.1425,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Office',
                                                    name: 'Office',
                                                    budget: 148.1425,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Office-Required',
                                                            name: 'Required',
                                                            budget: 148.1425,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                    ],
                                    error: false,
                                },
                                {
                                    id: '2',
                                    name: 'Amazon Advertising',
                                    budget: 1185.14,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '2-Sponsored Display',
                                            name: 'Sponsored Display',
                                            budget: 592.57,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '2-Sponsored Display-Services',
                                                    name: 'Services',
                                                    budget: 592.57,
                                                    percentage: 100,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Display-Services-Delivery',
                                                            name: 'Delivery',
                                                            budget: 296.285,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '2-Sponsored Display-Services-Repair',
                                                            name: 'Repair',
                                                            budget: 296.285,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                        {
                                            id: '2-Sponsored Products',
                                            name: 'Sponsored Products',
                                            budget: 592.57,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '2-Sponsored Products-Sports Drinks',
                                                    name: 'Sports Drinks',
                                                    budget: 296.285,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Products-Sports Drinks-Gatorade',
                                                            name: 'Gatorade',
                                                            budget: 592.57,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '2-Sponsored Products-Energy Drinks',
                                                    name: 'Energy Drinks',
                                                    budget: 296.285,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Products-Energy Drinks-Monster',
                                                            name: 'Monster',
                                                            budget: 148.1425,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '2-Sponsored Products-Energy Drinks-Red Bull',
                                                            name: 'Red Bull',
                                                            budget: 148.1425,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                    ],
                                    error: false,
                                },
                            ],
                            error: false,
                        },
                        november_2023: {
                            budget: 7110.84,
                            percentage: '33',
                            allocations: [
                                {
                                    id: '1',
                                    name: 'Google Ads',
                                    budget: 3555.42,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '1-SEARCH',
                                            name: 'SEARCH',
                                            budget: 1777.71,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '1-SEARCH-Products',
                                                    name: 'Primo Market Test | Bakersfield',
                                                    budget: 888.855,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SEARCH-Products-Water',
                                                            name: 'Mindful Morgan',
                                                            budget: 444.4275,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            bigquery_adset_id:
                                                                '142232761402',
                                                        },
                                                        {
                                                            id: '1-SEARCH-Products-Soda',
                                                            name: 'Soda',
                                                            budget: 444.4275,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                    bigquery_campaign_id:
                                                        '18195521903',
                                                },
                                                {
                                                    id: '1-SEARCH-Services',
                                                    name: 'Primo Market Test | Lafayette',
                                                    budget: 888.855,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SEARCH-Services-Dispenser',
                                                            name: 'Striving Selena',
                                                            budget: 444.4275,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            bigquery_adset_id:
                                                                '143495582551',
                                                        },
                                                        {
                                                            id: '1-SEARCH-Services-Delivery',
                                                            name: 'Delivery',
                                                            budget: 444.4275,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                    bigquery_campaign_id:
                                                        '18197143856',
                                                },
                                            ],
                                        },
                                        {
                                            id: '1-SHOPPING',
                                            name: 'SHOPPING',
                                            budget: 1777.71,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '1-SHOPPING-Products',
                                                    name: 'Products',
                                                    budget: 444.4275,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Products-Bottled',
                                                            name: 'Bottled',
                                                            budget: 444.4275,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '1-SHOPPING-Products-Free Flow',
                                                            name: 'Free Flow',
                                                            budget: 444.4275,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Services',
                                                    name: 'Services',
                                                    budget: 444.4275,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Services-Frontline',
                                                            name: 'Frontline',
                                                            budget: 444.4275,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Home',
                                                    name: 'Home',
                                                    budget: 444.4275,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Home-Program',
                                                            name: 'Program',
                                                            budget: 444.4275,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Office',
                                                    name: 'Office',
                                                    budget: 444.4275,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Office-Required',
                                                            name: 'Required',
                                                            budget: 444.4275,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                    ],
                                    error: false,
                                },
                                {
                                    id: '2',
                                    name: 'Amazon Advertising',
                                    budget: 3555.42,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '2-Sponsored Display',
                                            name: 'Sponsored Display',
                                            budget: 1777.71,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '2-Sponsored Display-Services',
                                                    name: 'Services',
                                                    budget: 1777.71,
                                                    percentage: 100,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Display-Services-Delivery',
                                                            name: 'Delivery',
                                                            budget: 888.855,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '2-Sponsored Display-Services-Repair',
                                                            name: 'Repair',
                                                            budget: 888.855,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                        {
                                            id: '2-Sponsored Products',
                                            name: 'Sponsored Products',
                                            budget: 1777.71,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '2-Sponsored Products-Sports Drinks',
                                                    name: 'Sports Drinks',
                                                    budget: 888.855,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Products-Sports Drinks-Gatorade',
                                                            name: 'Gatorade',
                                                            budget: 1777.71,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '2-Sponsored Products-Energy Drinks',
                                                    name: 'Energy Drinks',
                                                    budget: 888.855,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Products-Energy Drinks-Monster',
                                                            name: 'Monster',
                                                            budget: 444.4275,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '2-Sponsored Products-Energy Drinks-Red Bull',
                                                            name: 'Red Bull',
                                                            budget: 444.4275,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                    ],
                                    error: false,
                                },
                            ],
                            error: false,
                        },
                        december_2023: {
                            budget: 3447.6800000000003,
                            percentage: 16,
                            allocations: [
                                {
                                    id: '1',
                                    name: 'Google Ads',
                                    budget: 1723.84,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '1-SEARCH',
                                            name: 'SEARCH',
                                            budget: 861.92,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '1-SEARCH-Products',
                                                    name: 'Primo Market Test | Bakersfield',
                                                    budget: 430.96,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SEARCH-Products-Water',
                                                            name: 'Mindful Morgan',
                                                            budget: 215.48,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            bigquery_adset_id:
                                                                '142232761402',
                                                        },
                                                        {
                                                            id: '1-SEARCH-Products-Soda',
                                                            name: 'Soda',
                                                            budget: 215.48,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                    bigquery_campaign_id:
                                                        '18195521903',
                                                },
                                                {
                                                    id: '1-SEARCH-Services',
                                                    name: 'Primo Market Test | Lafayette',
                                                    budget: 430.96,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SEARCH-Services-Dispenser',
                                                            name: 'Striving Selena',
                                                            budget: 215.48,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            bigquery_adset_id:
                                                                '143495582551',
                                                        },
                                                        {
                                                            id: '1-SEARCH-Services-Delivery',
                                                            name: 'Delivery',
                                                            budget: 215.48,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                    bigquery_campaign_id:
                                                        '18197143856',
                                                },
                                            ],
                                        },
                                        {
                                            id: '1-SHOPPING',
                                            name: 'SHOPPING',
                                            budget: 861.92,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '1-SHOPPING-Products',
                                                    name: 'Products',
                                                    budget: 215.48,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Products-Bottled',
                                                            name: 'Bottled',
                                                            budget: 215.48,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '1-SHOPPING-Products-Free Flow',
                                                            name: 'Free Flow',
                                                            budget: 215.48,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Services',
                                                    name: 'Services',
                                                    budget: 215.48,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Services-Frontline',
                                                            name: 'Frontline',
                                                            budget: 215.48,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Home',
                                                    name: 'Home',
                                                    budget: 215.48,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Home-Program',
                                                            name: 'Program',
                                                            budget: 215.48,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Office',
                                                    name: 'Office',
                                                    budget: 215.48,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Office-Required',
                                                            name: 'Required',
                                                            budget: 215.48,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                    ],
                                    error: false,
                                },
                                {
                                    id: '2',
                                    name: 'Amazon Advertising',
                                    budget: 1723.84,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '2-Sponsored Display',
                                            name: 'Sponsored Display',
                                            budget: 861.92,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '2-Sponsored Display-Services',
                                                    name: 'Services',
                                                    budget: 861.92,
                                                    percentage: 100,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Display-Services-Delivery',
                                                            name: 'Delivery',
                                                            budget: 430.96,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '2-Sponsored Display-Services-Repair',
                                                            name: 'Repair',
                                                            budget: 430.96,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                        {
                                            id: '2-Sponsored Products',
                                            name: 'Sponsored Products',
                                            budget: 861.92,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '2-Sponsored Products-Sports Drinks',
                                                    name: 'Sports Drinks',
                                                    budget: 430.96,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Products-Sports Drinks-Gatorade',
                                                            name: 'Gatorade',
                                                            budget: 861.92,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '2-Sponsored Products-Energy Drinks',
                                                    name: 'Energy Drinks',
                                                    budget: 430.96,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Products-Energy Drinks-Monster',
                                                            name: 'Monster',
                                                            budget: 215.48,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '2-Sponsored Products-Energy Drinks-Red Bull',
                                                            name: 'Red Bull',
                                                            budget: 215.48,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                    ],
                                    error: false,
                                },
                            ],
                            error: false,
                        },
                        january_2024: {
                            budget: 3232.2,
                            percentage: '15',
                            allocations: [
                                {
                                    id: '1',
                                    name: 'Google Ads',
                                    budget: 1616.1,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '1-SEARCH',
                                            name: 'SEARCH',
                                            budget: 808.05,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '1-SEARCH-Products',
                                                    name: 'Primo Market Test | Bakersfield',
                                                    budget: 404.025,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SEARCH-Products-Water',
                                                            name: 'Mindful Morgan',
                                                            budget: 202.0125,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            bigquery_adset_id:
                                                                '142232761402',
                                                        },
                                                        {
                                                            id: '1-SEARCH-Products-Soda',
                                                            name: 'Soda',
                                                            budget: 202.0125,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                    bigquery_campaign_id:
                                                        '18195521903',
                                                },
                                                {
                                                    id: '1-SEARCH-Services',
                                                    name: 'Primo Market Test | Lafayette',
                                                    budget: 404.025,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SEARCH-Services-Dispenser',
                                                            name: 'Striving Selena',
                                                            budget: 202.0125,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            bigquery_adset_id:
                                                                '143495582551',
                                                        },
                                                        {
                                                            id: '1-SEARCH-Services-Delivery',
                                                            name: 'Delivery',
                                                            budget: 202.0125,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                    bigquery_campaign_id:
                                                        '18197143856',
                                                },
                                            ],
                                        },
                                        {
                                            id: '1-SHOPPING',
                                            name: 'SHOPPING',
                                            budget: 808.05,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '1-SHOPPING-Products',
                                                    name: 'Products',
                                                    budget: 202.0125,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Products-Bottled',
                                                            name: 'Bottled',
                                                            budget: 202.0125,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '1-SHOPPING-Products-Free Flow',
                                                            name: 'Free Flow',
                                                            budget: 202.0125,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Services',
                                                    name: 'Services',
                                                    budget: 202.0125,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Services-Frontline',
                                                            name: 'Frontline',
                                                            budget: 202.0125,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Home',
                                                    name: 'Home',
                                                    budget: 202.0125,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Home-Program',
                                                            name: 'Program',
                                                            budget: 202.0125,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Office',
                                                    name: 'Office',
                                                    budget: 202.0125,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Office-Required',
                                                            name: 'Required',
                                                            budget: 202.0125,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                    ],
                                    error: false,
                                },
                                {
                                    id: '2',
                                    name: 'Amazon Advertising',
                                    budget: 1616.1,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '2-Sponsored Display',
                                            name: 'Sponsored Display',
                                            budget: 808.05,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '2-Sponsored Display-Services',
                                                    name: 'Services',
                                                    budget: 808.05,
                                                    percentage: 100,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Display-Services-Delivery',
                                                            name: 'Delivery',
                                                            budget: 404.025,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '2-Sponsored Display-Services-Repair',
                                                            name: 'Repair',
                                                            budget: 404.025,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                        {
                                            id: '2-Sponsored Products',
                                            name: 'Sponsored Products',
                                            budget: 808.05,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '2-Sponsored Products-Sports Drinks',
                                                    name: 'Sports Drinks',
                                                    budget: 404.025,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Products-Sports Drinks-Gatorade',
                                                            name: 'Gatorade',
                                                            budget: 808.05,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '2-Sponsored Products-Energy Drinks',
                                                    name: 'Energy Drinks',
                                                    budget: 404.025,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Products-Energy Drinks-Monster',
                                                            name: 'Monster',
                                                            budget: 202.0125,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '2-Sponsored Products-Energy Drinks-Red Bull',
                                                            name: 'Red Bull',
                                                            budget: 202.0125,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                    ],
                                    error: false,
                                },
                            ],
                            error: false,
                        },
                        february_2024: {
                            budget: 3232.2,
                            percentage: '15',
                            allocations: [
                                {
                                    id: '1',
                                    name: 'Google Ads',
                                    budget: 1616.1,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '1-SEARCH',
                                            name: 'SEARCH',
                                            budget: 808.05,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '1-SEARCH-Products',
                                                    name: 'Primo Market Test | Bakersfield',
                                                    budget: 404.025,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SEARCH-Products-Water',
                                                            name: 'Mindful Morgan',
                                                            budget: 202.0125,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            bigquery_adset_id:
                                                                '142232761402',
                                                        },
                                                        {
                                                            id: '1-SEARCH-Products-Soda',
                                                            name: 'Soda',
                                                            budget: 202.0125,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                    bigquery_campaign_id:
                                                        '18195521903',
                                                },
                                                {
                                                    id: '1-SEARCH-Services',
                                                    name: 'Primo Market Test | Lafayette',
                                                    budget: 404.025,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SEARCH-Services-Dispenser',
                                                            name: 'Striving Selena',
                                                            budget: 202.0125,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                            bigquery_adset_id:
                                                                '143495582551',
                                                        },
                                                        {
                                                            id: '1-SEARCH-Services-Delivery',
                                                            name: 'Delivery',
                                                            budget: 202.0125,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                    bigquery_campaign_id:
                                                        '18197143856',
                                                },
                                            ],
                                        },
                                        {
                                            id: '1-SHOPPING',
                                            name: 'SHOPPING',
                                            budget: 808.05,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '1-SHOPPING-Products',
                                                    name: 'Products',
                                                    budget: 202.0125,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Products-Bottled',
                                                            name: 'Bottled',
                                                            budget: 202.0125,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '1-SHOPPING-Products-Free Flow',
                                                            name: 'Free Flow',
                                                            budget: 202.0125,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Services',
                                                    name: 'Services',
                                                    budget: 202.0125,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Services-Frontline',
                                                            name: 'Frontline',
                                                            budget: 202.0125,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Home',
                                                    name: 'Home',
                                                    budget: 202.0125,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Home-Program',
                                                            name: 'Program',
                                                            budget: 202.0125,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '1-SHOPPING-Office',
                                                    name: 'Office',
                                                    budget: 202.0125,
                                                    percentage: 25,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '1-SHOPPING-Office-Required',
                                                            name: 'Required',
                                                            budget: 202.0125,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                    ],
                                    error: false,
                                },
                                {
                                    id: '2',
                                    name: 'Amazon Advertising',
                                    budget: 1616.1,
                                    percentage: 50,
                                    type: 'CHANNEL',
                                    allocations: [
                                        {
                                            id: '2-Sponsored Display',
                                            name: 'Sponsored Display',
                                            budget: 808.05,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '2-Sponsored Display-Services',
                                                    name: 'Services',
                                                    budget: 808.05,
                                                    percentage: 100,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Display-Services-Delivery',
                                                            name: 'Delivery',
                                                            budget: 404.025,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '2-Sponsored Display-Services-Repair',
                                                            name: 'Repair',
                                                            budget: 404.025,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                        {
                                            id: '2-Sponsored Products',
                                            name: 'Sponsored Products',
                                            budget: 808.05,
                                            percentage: 50,
                                            type: 'CAMPAIGN_TYPE',
                                            allocations: [
                                                {
                                                    id: '2-Sponsored Products-Sports Drinks',
                                                    name: 'Sports Drinks',
                                                    budget: 404.025,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Products-Sports Drinks-Gatorade',
                                                            name: 'Gatorade',
                                                            budget: 808.05,
                                                            percentage: 100,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                                {
                                                    id: '2-Sponsored Products-Energy Drinks',
                                                    name: 'Energy Drinks',
                                                    budget: 404.025,
                                                    percentage: 50,
                                                    goals: '',
                                                    type: 'CAMPAIGN',
                                                    allocations: [
                                                        {
                                                            id: '2-Sponsored Products-Energy Drinks-Monster',
                                                            name: 'Monster',
                                                            budget: 202.0125,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                        {
                                                            id: '2-Sponsored Products-Energy Drinks-Red Bull',
                                                            name: 'Red Bull',
                                                            budget: 202.0125,
                                                            percentage: 50,
                                                            type: 'ADSET',
                                                        },
                                                    ],
                                                },
                                            ],
                                        },
                                    ],
                                    error: false,
                                },
                            ],
                            error: false,
                        },
                    },
                },
            ],
        };

        const currentDate = new Date('Sep 20 2023');

        bigqueryClient.query.mockResolvedValue([
            [{ _date: '2023-09-20', spend: 0 }],
        ]);

        const { periods, allocations } = await computeAndStoreMetrics({
            campaign,
            currentDate,
        });

        expect(periods).toEqual(campaign.budgets[0].periods);
        expect(allocations).toEqual(expectedAllocations);
    });
});
